<!-- <div class="loadingOverlay animate" ng-if="processingQuery">
  <i class="fa fa-circle-o-notch fa-spin"></i>
</div> -->

<div class="container-fluid">
  <div class="row">
    <div class="feed">

      <div class="card text-cs-center">
        <div class="card-header">
          Displaying
          <strong>{{totalPosts}}</strong>
          Posts
        </div>
        <div class="card-block">
          <div class="scroll-body" slimscroll="{
            height: 'auto',
            color: '#333',
            railVisible: true,
            railOpacity: '0.7',
            railColor: '#DDDDDD'
          }">
            <div class="posts-timeline animate" ng-repeat="posts in fixedPosts track by $index | orderBy : '-date'">
              <div class="pt-line text-right">
                <strong>{{posts.date | date:'M/dd/yyyy'}}</strong>
                <span class="d-block">
                  <span ng-if="isToday(posts.date)">Today</span>
                  <span ng-if="!isToday(posts.date)">{{today | amDifference : posts.date : 'days'}} days ago</span>
                </span>
              </div>

              <div class="pt-body">
                <div class="clearfix">
                  <div class="person animate" ng-repeat="post in posts.posts">
                    <div class="emotionOverlay eo-{{post.positiveScale}}">
                      <div class="eo-inner">
                        <div class="eo-bottom-bar eo-{{post.positiveScale}}">
                          <div class="eo-comments">
                            3
                            <i class="fa fa-comment"></i>
                          </div>
                          <div class="eo-time">{{post.datePosted | date:'shortTime'}}</div>
                          <div class="eo-post" ui-sref="post({id:post._id})">
                            <i class="fa fa-external-link"></i>
                          </div>
                        </div>
                        <div class="eo-number">{{post.positiveScale}}</div>
                        <div class="eo-tags">
                          <div class="scroll-body" slimscroll="{
                              height: 'auto',
                              color: '#777',
                              railOpacity: '0.7',
                              size: '3px'
                            }">
                            <span ng-repeat="tag in post.tags">{{tag}}</span>
                          </div>
                        </div>
                        <img ng-src="assets/img/faces/face-{{post.positiveScale - 1}}.svg" class="eo-face">
                      </div>
                    </div>
                    <img class="gravatar" gravatar-src="post.user.email" gravatar-size="70" gravatar-default="mm">
                  </div>
                </div>

              </div>
              <!--/.pt-body-->
            </div>
            <!--/.posts-timeline-->
            <!-- <pre>{{fixedPosts}}</pre>
          <pre>{{posts}}</pre> -->
          </div>
        </div>
      </div>
    </div>

    <div class="sidebar">
      <div class="scroll-body" slimscroll="{
        height: 'auto',
        color: '#CCC',
        railVisible: true,
        railOpacity: '0.7'
      }">

        <form id="create-post" ng-submit="createPost()">

          <fieldset class="form-group">
            <label for="emotionlevel">Hey
              <span class="capitalize">{{currentUser.firstName}}</span>, how are you feeling?</label>

            <div class="emotions">
              <div class="emotionWrapper" ng-repeat="i in repeatEmotions() track by $index" ng-class="{'toggled':postContent.positiveScale == $index + 1}">
                <ng-include ng-click="setScale($index)" class="emotionSvg" src="'assets/img/faces/face-'+$index+'.svg'"></ng-include>
                {{$index + 1}}
              </div>
              <div class="scalewrap">
                <span class="negative">NEGATIVE</span>
                <span class="positive">POSITIVE</span>
              </div>
            </div>
          </fieldset>

          <fieldset class="form-group fancy-input" ng-class="{'input--filled': postContent.tags.length > 0}">
              <tags-input class="input__field" ng-model="postContent.tags" display-property="name" placeholder="..." replace-spaces-with-dashes="false" maxLength="20" minTags="1" maxTags="5" allowLeftoverText="false" addOnEnter="false" spellcheck="false">
                <auto-complete source="loadAutoCompleteTags('tags', $query)" min-length="2" maxResultsToShow="5"></auto-complete>
              </tags-input>
              <label class="input__label" for="tags">
                <span class="input__label-content" data-content="What are you working on?">What are you working on?</span>
              </label>
          </fieldset>

          <fieldset class="form-group fancy-input" ng-class="{'input--filled': postContent.body}">
            <textarea class="form-control input__field" id="thoughts" rows="1" ng-model="postContent.body"></textarea>
            <label class="input__label" for="thoughts">
              <span class="input__label-content" data-content="Thoughts?">Thoughts?</span>
            </label>
          </fieldset>

          <button type="submit" class="btn btn-primary">Submit</button>
        </form>
        <!--/.input form-->

        <hr>

        <h5>Search</h5>
        <form ng-submit="createQuery()">

          <fieldset class="form-group fancy-input" ng-class="{'input--filled': query.firstName.length > 0}">
              <tags-input id="searchFirstName" class="input__field" ng-model="query.firstName" display-property="name" placeholder="..." replace-spaces-with-dashes="false" maxLength="20" minTags="1" maxTags="5" allowLeftoverText="false" addOnEnter="false" spellcheck="false">
                <auto-complete source="loadAutoCompleteTags('firstName', $query)" min-length="2" maxResultsToShow="5"></auto-complete>
              </tags-input>
              <label class="input__label" for="searchFirstName">
                <span class="input__label-content" data-content="First Name">First Name</span>
              </label>
          </fieldset>

          <fieldset class="form-group fancy-input" ng-class="{'input--filled': query.lastName.length > 0}">
            <tags-input id="searchLastName" class="input__field" ng-model="query.lastName" display-property="name" placeholder="..." replace-spaces-with-dashes="false" maxLength="20" minTags="1" maxTags="5" allowLeftoverText="false" addOnEnter="false" spellcheck="false">
              <auto-complete source="loadAutoCompleteTags('lastName', $query)" min-length="2" maxResultsToShow="5"></auto-complete>
            </tags-input>
            <label class="input__label" for="searchLastName">
              <span class="input__label-content" data-content="Last Name">Last Name</span>
            </label>
          </fieldset>

          <fieldset class="form-group fancy-input" ng-class="{'input--filled': query.tags.length > 0}">
            <tags-input id="searchTags" class="input__field" ng-model="query.tags" display-property="name" placeholder="..." replace-spaces-with-dashes="false" maxLength="20" minTags="1" maxTags="5" allowLeftoverText="false" addOnEnter="false" spellcheck="false">
              <auto-complete source="loadAutoCompleteTags('tags', $query)" min-length="2" maxResultsToShow="5"></auto-complete>
            </tags-input>
            <label class="input__label" for="searchLastName">
              <span class="input__label-content" data-content="Working On">Working On</span>
            </label>
          </fieldset>

          <fieldset class="form-group fancy-input">
            <div id="daterange" class="pull-right form-control input__field" style="cursor: pointer; padding: 5px 10px;">
              <i class="fa fa-calendar"></i>&nbsp;
              <label class="input__label" for="daterange">
                <span class="input__label-content" data-content="Date">Date</span>
              </label>
            </div>
          </fieldset>

          <fieldset class="form-group fancy-input">
            <div class="emotions">
              <div class="emotionWrapper" ng-repeat="i in repeatEmotions() track by $index" ng-class="{'toggled' : query.positiveScale.indexOf($index + 1) !== -1}">
                <ng-include ng-click="setScaleQuery($index)" class="emotionSvg" src="'assets/img/faces/face-'+$index+'.svg'"></ng-include>
                {{$index + 1}}
              </div>
              <div class="scalewrap">
                <span class="negative">NEGATIVE</span>
                <span class="positive">POSITIVE</span>
              </div>
            </div>
          </fieldset>

          <button type="submit" class="btn btn-primary" ng-disabled="processingQuery">Submit</button>
          <a class="btn btn-secondary" ng-click="clearQuery()">Clear</a>

        </form>
        {{query}}
        <div id="query_error_msg" ng-show="queryErrorMsg">{{queryErrorMsg}}</div>
      </div>
      <!--/slimscroll-->
    </div>
    <!--/.sidebar-->
  </div>
  <!--/.row-->
</div>
<!--/.container-fluid-->
